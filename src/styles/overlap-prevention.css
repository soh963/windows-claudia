/* UI Overlap Prevention Styles
   These styles ensure proper layering and prevent UI elements from overlapping
*/

/* Z-Index Scale
   Define a consistent z-index scale to prevent conflicts
*/
:root {
  --z-base: 0;
  --z-dropdown: 10;
  --z-sticky: 20;
  --z-fixed: 30;
  --z-overlay: 40;
  --z-modal: 50;
  --z-notification: 60;
  --z-tooltip: 70;
  --z-max: 9999;
}

/* Progress Tracker Specific Positioning */
.progress-tracker-container {
  position: fixed;
  z-index: var(--z-overlay);
  pointer-events: none; /* Allow clicks to pass through container */
}

.progress-tracker-container > * {
  pointer-events: auto; /* But make content interactive */
}

/* Ensure Progress Tracker doesn't interfere with chat */
.progress-tracker-embedded {
  position: absolute;
  z-index: var(--z-sticky);
  max-height: calc(100vh - 2rem);
  overflow-y: auto;
  overflow-x: hidden;
}

/* Top-right positioning with safe margins */
.progress-tracker-embedded.position-top-right {
  top: 1rem;
  right: 1rem;
  margin-top: env(safe-area-inset-top, 0);
  margin-right: env(safe-area-inset-right, 0);
}

/* Prevent overlap with floating elements */
.chat-window-container {
  position: relative;
  z-index: var(--z-base);
}

.chat-input-area {
  position: relative;
  z-index: var(--z-base);
}

/* Model Selector Dropdown Positioning */
.model-selector-dropdown {
  z-index: var(--z-dropdown);
  max-height: min(600px, calc(100vh - 2rem));
  overflow-y: auto;
}

/* Ensure dropdowns don't get cut off */
[data-radix-ui-popper-content] {
  z-index: var(--z-dropdown) !important;
}

/* Floating buttons with proper spacing */
.floating-action-button {
  position: fixed;
  z-index: var(--z-fixed);
  margin: 1rem;
}

/* Responsive adjustments for mobile */
@media (max-width: 768px) {
  .progress-tracker-embedded {
    max-width: calc(100vw - 2rem);
    max-height: 50vh;
  }
  
  .progress-tracker-embedded.position-top-right {
    top: 0.5rem;
    right: 0.5rem;
    left: auto;
    bottom: auto;
  }
  
  /* Stack elements vertically on mobile */
  .model-selector-dropdown {
    max-width: calc(100vw - 2rem);
  }
}

/* Tablet adjustments */
@media (min-width: 769px) and (max-width: 1024px) {
  .progress-tracker-embedded {
    max-width: 350px;
  }
}

/* Prevent content from being hidden behind fixed elements */
.main-content-area {
  padding-top: env(safe-area-inset-top, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}

/* Intelligent Chat positioning */
.intelligent-chat-container {
  position: relative;
  z-index: var(--z-base);
  margin-bottom: 1rem;
}

/* Ensure modals are always on top */
.modal-backdrop {
  position: fixed;
  inset: 0;
  z-index: var(--z-modal);
}

.modal-content {
  position: fixed;
  z-index: calc(var(--z-modal) + 1);
}

/* Tooltip positioning */
[role="tooltip"] {
  z-index: var(--z-tooltip) !important;
}

/* Prevent overflow issues */
.overflow-prevention {
  overflow: hidden;
  position: relative;
}

/* Collapsible panels should not overlap */
.collapsible-panel {
  position: relative;
  z-index: var(--z-base);
  transition: all 0.3s ease;
}

.collapsible-panel.expanded {
  z-index: var(--z-sticky);
}

/* Safe area for iOS devices */
.safe-area-container {
  padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) 
           env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
}

/* Prevent text selection from causing layout issues */
.no-select {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* Smooth transitions for layout changes */
.layout-transition {
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* Focus indicators that don't cause layout shifts */
.focus-visible:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

.focus-visible:focus:not(:focus-visible) {
  outline: none;
}

/* Prevent horizontal scrolling */
.prevent-horizontal-scroll {
  overflow-x: hidden;
  max-width: 100vw;
}

/* Grid-based layout for predictable positioning */
.ui-grid {
  display: grid;
  gap: 1rem;
  grid-template-areas:
    "header header"
    "sidebar main"
    "footer footer";
}

@media (max-width: 768px) {
  .ui-grid {
    grid-template-areas:
      "header"
      "main"
      "sidebar"
      "footer";
  }
}

/* Sticky positioning with proper containment */
.sticky-header {
  position: sticky;
  top: 0;
  z-index: var(--z-sticky);
  background-color: var(--color-background);
  backdrop-filter: blur(10px);
}

/* Ensure clickable areas don't overlap */
.clickable-area {
  position: relative;
  isolation: isolate;
}

/* Performance optimizations */
.gpu-accelerated {
  transform: translateZ(0);
  will-change: transform;
}

/* Backdrop blur for better visual separation */
.backdrop-blur {
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* Custom scrollbar that doesn't affect layout */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(156, 163, 175, 0.3) transparent;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(156, 163, 175, 0.3);
  border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: rgba(156, 163, 175, 0.5);
}

/* Prevent margin collapse */
.prevent-margin-collapse::before,
.prevent-margin-collapse::after {
  content: '';
  display: table;
}

/* RTL support */
[dir="rtl"] .progress-tracker-embedded.position-top-right {
  right: auto;
  left: 1rem;
}

[dir="rtl"] .floating-action-button {
  right: auto;
  left: 1rem;
}